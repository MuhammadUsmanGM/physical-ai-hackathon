"use strict";(globalThis.webpackChunkbook=globalThis.webpackChunkbook||[]).push([[2113],{8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>o});var a=r(6540);const s={},t=a.createContext(s);function i(e){const n=a.useContext(t);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(t.Provider,{value:n},e.children)}},8595:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"The-Robotic-Nervous-System/Building-ROS2-Packages/building-ros2-packages","title":"Building ROS 2 Packages with Python","description":"Introduction","source":"@site/docs/02-The-Robotic-Nervous-System/05-Building-ROS2-Packages/index.md","sourceDirName":"02-The-Robotic-Nervous-System/05-Building-ROS2-Packages","slug":"/module-02/building-ros2-packages","permalink":"/physical-ai-hackathon/docs/module-02/building-ros2-packages","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02-The-Robotic-Nervous-System/05-Building-ROS2-Packages/index.md","tags":[],"version":"current","frontMatter":{"id":"building-ros2-packages","title":"Building ROS 2 Packages with Python","slug":"/module-02/building-ros2-packages"},"sidebar":"tutorialSidebar","previous":{"title":"URDF for Humanoid Robots","permalink":"/physical-ai-hackathon/docs/module-02/urdf-for-humanoids"},"next":{"title":"Launch Files and Parameter Management","permalink":"/physical-ai-hackathon/docs/module-02/launch-files-parameters"}}');var s=r(4848),t=r(8453);const i={id:"building-ros2-packages",title:"Building ROS 2 Packages with Python",slug:"/module-02/building-ros2-packages"},o="Building ROS 2 Packages with Python",l={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Package Structure Overview",id:"package-structure-overview",level:2},{value:"Creating Your First ROS 2 Package",id:"creating-your-first-ros-2-package",level:2},{value:"Step 1: Navigate to Your Workspace",id:"step-1-navigate-to-your-workspace",level:3},{value:"Step 2: Create the Package",id:"step-2-create-the-package",level:3},{value:"Step 3: Examine the Generated Files",id:"step-3-examine-the-generated-files",level:3},{value:"Understanding package.xml",id:"understanding-packagexml",level:2},{value:"Dependency Types",id:"dependency-types",level:3},{value:"Understanding setup.py",id:"understanding-setuppy",level:2},{value:"Entry Points Explained",id:"entry-points-explained",level:3},{value:"Creating a Complete Node",id:"creating-a-complete-node",level:2},{value:"Example: IMU Data Processor Node",id:"example-imu-data-processor-node",level:3},{value:"Add Entry Point to setup.py",id:"add-entry-point-to-setuppy",level:3},{value:"Building and Installing the Package",id:"building-and-installing-the-package",level:2},{value:"Step 1: Build the Package",id:"step-1-build-the-package",level:3},{value:"Step 2: Source the Workspace",id:"step-2-source-the-workspace",level:3},{value:"Step 3: Run the Node",id:"step-3-run-the-node",level:3},{value:"Creating Configuration Files",id:"creating-configuration-files",level:2},{value:"Parameter YAML File",id:"parameter-yaml-file",level:3},{value:"Using Parameters from File",id:"using-parameters-from-file",level:3},{value:"Creating Launch Files",id:"creating-launch-files",level:2},{value:"Python Launch File",id:"python-launch-file",level:3},{value:"Running the Launch File",id:"running-the-launch-file",level:3},{value:"Package Organization Best Practices",id:"package-organization-best-practices",level:2},{value:"Directory Structure for Large Projects",id:"directory-structure-for-large-projects",level:3},{value:"Testing Your Package",id:"testing-your-package",level:2},{value:"Unit Test Example",id:"unit-test-example",level:3},{value:"Running Tests",id:"running-tests",level:3},{value:"Common Package Commands",id:"common-package-commands",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Summary",id:"summary",level:2},{value:"Further Reading",id:"further-reading",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"building-ros-2-packages-with-python",children:"Building ROS 2 Packages with Python"})}),"\n",(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsxs)(n.p,{children:["A ",(0,s.jsx)(n.strong,{children:"ROS 2 package"})," is the fundamental unit of organization for ROS code. Packages contain nodes, libraries, configuration files, and other resources needed for your robot application. In this chapter, you'll learn to create, build, and organize ROS 2 packages using Python, the primary language for rapid robotics development."]}),"\n",(0,s.jsx)(n.h2,{id:"package-structure-overview",children:"Package Structure Overview"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"my_robot_package/\r\n\u251c\u2500\u2500 package.xml          # Package metadata and dependencies\r\n\u251c\u2500\u2500 setup.py             # Python package configuration\r\n\u251c\u2500\u2500 setup.cfg            # Additional Python setup configuration\r\n\u251c\u2500\u2500 resource/            # Package marker file\r\n\u2502   \u2514\u2500\u2500 my_robot_package\r\n\u251c\u2500\u2500 my_robot_package/    # Python source code directory\r\n\u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u251c\u2500\u2500 my_node.py\r\n\u2502   \u2514\u2500\u2500 utils.py\r\n\u251c\u2500\u2500 launch/              # Launch files\r\n\u2502   \u2514\u2500\u2500 my_launch.py\r\n\u251c\u2500\u2500 config/              # Configuration files (YAML, etc.)\r\n\u2502   \u2514\u2500\u2500 params.yaml\r\n\u251c\u2500\u2500 urdf/                # Robot descriptions\r\n\u2502   \u2514\u2500\u2500 robot.urdf\r\n\u2514\u2500\u2500 test/                # Unit tests\r\n    \u2514\u2500\u2500 test_my_node.py\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"creating-your-first-ros-2-package",children:"Creating Your First ROS 2 Package"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-navigate-to-your-workspace",children:"Step 1: Navigate to Your Workspace"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws/src\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-2-create-the-package",children:"Step 2: Create the Package"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Create a Python package with dependencies\r\nros2 pkg create --build-type ament_python my_robot_package \\\r\n  --dependencies rclpy std_msgs sensor_msgs geometry_msgs\r\n\r\n# Explanation:\r\n# --build-type ament_python: Python package (vs ament_cmake for C++)\r\n# --dependencies: Automatically adds these to package.xml\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Output:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"going to create a new package\r\npackage name: my_robot_package\r\ndestination directory: /home/user/ros2_ws/src\r\npackage format: 3\r\nversion: 0.0.0\r\ndescription: TODO: Package description\r\nmaintainer: ['user <user@todo.todo>']\r\nlicenses: ['TODO: License declaration']\r\nbuild type: ament_python\r\ndependencies: ['rclpy', 'std_msgs', 'sensor_msgs', 'geometry_msgs']\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-3-examine-the-generated-files",children:"Step 3: Examine the Generated Files"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd my_robot_package\r\ntree\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"understanding-packagexml",children:"Understanding package.xml"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"package.xml"})," file contains metadata about your package:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\r\n<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>\r\n<package format="3">\r\n  <name>my_robot_package</name>\r\n  <version>0.1.0</version>\r\n  <description>Humanoid robot control package</description>\r\n  <maintainer email="you@example.com">Your Name</maintainer>\r\n  <license>Apache-2.0</license>\r\n\r\n  \x3c!-- Build tool dependency --\x3e\r\n  <buildtool_depend>ament_python</buildtool_depend>\r\n\r\n  \x3c!-- Runtime dependencies --\x3e\r\n  <depend>rclpy</depend>\r\n  <depend>std_msgs</depend>\r\n  <depend>sensor_msgs</depend>\r\n  <depend>geometry_msgs</depend>\r\n\r\n  \x3c!-- Test dependencies --\x3e\r\n  <test_depend>ament_copyright</test_depend>\r\n  <test_depend>ament_flake8</test_depend>\r\n  <test_depend>ament_pep257</test_depend>\r\n  <test_depend>python3-pytest</test_depend>\r\n\r\n  <export>\r\n    <build_type>ament_python</build_type>\r\n  </export>\r\n</package>\n'})}),"\n",(0,s.jsx)(n.h3,{id:"dependency-types",children:"Dependency Types"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Tag"}),(0,s.jsx)(n.th,{children:"Purpose"}),(0,s.jsx)(n.th,{children:"Example"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"<buildtool_depend>"})}),(0,s.jsx)(n.td,{children:"Tools needed to build"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"ament_python"}),", ",(0,s.jsx)(n.code,{children:"ament_cmake"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"<depend>"})}),(0,s.jsx)(n.td,{children:"Build + runtime dependency"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"rclpy"}),", ",(0,s.jsx)(n.code,{children:"std_msgs"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"<build_depend>"})}),(0,s.jsx)(n.td,{children:"Only needed for building"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"rosidl_default_generators"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"<exec_depend>"})}),(0,s.jsx)(n.td,{children:"Only needed at runtime"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"python3-numpy"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"<test_depend>"})}),(0,s.jsx)(n.td,{children:"Only needed for testing"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"pytest"}),", ",(0,s.jsx)(n.code,{children:"ament_lint"})]})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"understanding-setuppy",children:"Understanding setup.py"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"setup.py"})," file configures the Python package:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from setuptools import find_packages, setup\r\nimport os\r\nfrom glob import glob\r\n\r\npackage_name = 'my_robot_package'\r\n\r\nsetup(\r\n    name=package_name,\r\n    version='0.1.0',\r\n    packages=find_packages(exclude=['test']),\r\n    data_files=[\r\n        # Install package marker\r\n        ('share/ament_index/resource_index/packages',\r\n            ['resource/' + package_name]),\r\n        # Install package.xml\r\n        ('share/' + package_name, ['package.xml']),\r\n        # Install launch files\r\n        (os.path.join('share', package_name, 'launch'),\r\n            glob(os.path.join('launch', '*launch.[pxy][yma]*'))),\r\n        # Install config files\r\n        (os.path.join('share', package_name, 'config'),\r\n            glob('config/*.yaml')),\r\n        # Install URDF files\r\n        (os.path.join('share', package_name, 'urdf'),\r\n            glob('urdf/*.urdf')),\r\n    ],\r\n    install_requires=['setuptools'],\r\n    zip_safe=True,\r\n    maintainer='Your Name',\r\n    maintainer_email='you@example.com',\r\n    description='Humanoid robot control package',\r\n    license='Apache-2.0',\r\n    tests_require=['pytest'],\r\n    entry_points={\r\n        'console_scripts': [\r\n            'my_node = my_robot_package.my_node:main',\r\n            'sensor_processor = my_robot_package.sensor_processor:main',\r\n            'controller = my_robot_package.controller:main',\r\n        ],\r\n    },\r\n)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"entry-points-explained",children:"Entry Points Explained"}),"\n",(0,s.jsx)(n.p,{children:"Entry points define executable scripts:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"'console_scripts': [\r\n    'executable_name = package_name.module_name:function_name',\r\n]\n"})}),"\n",(0,s.jsx)(n.p,{children:"This allows you to run:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 run my_robot_package executable_name\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"creating-a-complete-node",children:"Creating a Complete Node"}),"\n",(0,s.jsx)(n.h3,{id:"example-imu-data-processor-node",children:"Example: IMU Data Processor Node"}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"my_robot_package/sensor_processor.py"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\r\n"""\r\nSensor Processor Node\r\nSubscribes to IMU data, processes it, and publishes filtered output\r\n"""\r\n\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom sensor_msgs.msg import Imu\r\nfrom geometry_msgs.msg import Vector3Stamped\r\nimport numpy as np\r\nfrom collections import deque\r\n\r\nclass SensorProcessor(Node):\r\n    """\r\n    Processes IMU sensor data with filtering and anomaly detection.\r\n    """\r\n    \r\n    def __init__(self):\r\n        super().__init__(\'sensor_processor\')\r\n        \r\n        # Declare parameters\r\n        self.declare_parameter(\'window_size\', 10)\r\n        self.declare_parameter(\'max_angular_velocity\', 5.0)\r\n        self.declare_parameter(\'publish_rate\', 50.0)\r\n        \r\n        # Get parameters\r\n        self.window_size = self.get_parameter(\'window_size\').value\r\n        self.max_angular_vel = self.get_parameter(\'max_angular_velocity\').value\r\n        self.publish_rate = self.get_parameter(\'publish_rate\').value\r\n        \r\n        # Create subscriber\r\n        self.imu_sub = self.create_subscription(\r\n            Imu,\r\n            \'imu/data_raw\',\r\n            self.imu_callback,\r\n            10\r\n        )\r\n        \r\n        # Create publishers\r\n        self.filtered_pub = self.create_publisher(\r\n            Vector3Stamped,\r\n            \'imu/angular_velocity_filtered\',\r\n            10\r\n        )\r\n        \r\n        self.anomaly_pub = self.create_publisher(\r\n            Vector3Stamped,\r\n            \'imu/anomalies\',\r\n            10\r\n        )\r\n        \r\n        # Initialize moving average buffers\r\n        self.angular_vel_buffer_x = deque(maxlen=self.window_size)\r\n        self.angular_vel_buffer_y = deque(maxlen=self.window_size)\r\n        self.angular_vel_buffer_z = deque(maxlen=self.window_size)\r\n        \r\n        # Statistics\r\n        self.message_count = 0\r\n        self.anomaly_count = 0\r\n        \r\n        # Create timer for logging statistics\r\n        self.stats_timer = self.create_timer(1.0, self.log_statistics)\r\n        \r\n        self.get_logger().info(\r\n            f\'Sensor Processor initialized with window_size={self.window_size}\'\r\n        )\r\n    \r\n    def imu_callback(self, msg):\r\n        """Process incoming IMU data"""\r\n        self.message_count += 1\r\n        \r\n        # Extract angular velocity\r\n        ang_vel_x = msg.angular_velocity.x\r\n        ang_vel_y = msg.angular_velocity.y\r\n        ang_vel_z = msg.angular_velocity.z\r\n        \r\n        # Check for anomalies\r\n        if self.is_anomaly(ang_vel_x, ang_vel_y, ang_vel_z):\r\n            self.anomaly_count += 1\r\n            self.publish_anomaly(msg.header, ang_vel_x, ang_vel_y, ang_vel_z)\r\n            return  # Skip filtering for anomalous data\r\n        \r\n        # Add to moving average buffers\r\n        self.angular_vel_buffer_x.append(ang_vel_x)\r\n        self.angular_vel_buffer_y.append(ang_vel_y)\r\n        self.angular_vel_buffer_z.append(ang_vel_z)\r\n        \r\n        # Calculate filtered values (moving average)\r\n        filtered_x = np.mean(self.angular_vel_buffer_x)\r\n        filtered_y = np.mean(self.angular_vel_buffer_y)\r\n        filtered_z = np.mean(self.angular_vel_buffer_z)\r\n        \r\n        # Publish filtered data\r\n        self.publish_filtered(msg.header, filtered_x, filtered_y, filtered_z)\r\n    \r\n    def is_anomaly(self, x, y, z):\r\n        """Check if angular velocity exceeds threshold"""\r\n        magnitude = np.sqrt(x**2 + y**2 + z**2)\r\n        return magnitude > self.max_angular_vel\r\n    \r\n    def publish_filtered(self, header, x, y, z):\r\n        """Publish filtered angular velocity"""\r\n        msg = Vector3Stamped()\r\n        msg.header = header\r\n        msg.vector.x = x\r\n        msg.vector.y = y\r\n        msg.vector.z = z\r\n        self.filtered_pub.publish(msg)\r\n    \r\n    def publish_anomaly(self, header, x, y, z):\r\n        """Publish detected anomaly"""\r\n        msg = Vector3Stamped()\r\n        msg.header = header\r\n        msg.vector.x = x\r\n        msg.vector.y = y\r\n        msg.vector.z = z\r\n        self.anomaly_pub.publish(msg)\r\n        \r\n        self.get_logger().warn(\r\n            f\'Anomaly detected: magnitude={np.sqrt(x**2 + y**2 + z**2):.2f} rad/s\'\r\n        )\r\n    \r\n    def log_statistics(self):\r\n        """Log processing statistics"""\r\n        if self.message_count > 0:\r\n            anomaly_rate = (self.anomaly_count / self.message_count) * 100\r\n            self.get_logger().info(\r\n                f\'Processed {self.message_count} messages, \'\r\n                f\'{self.anomaly_count} anomalies ({anomaly_rate:.1f}%)\'\r\n            )\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    sensor_processor = SensorProcessor()\r\n    \r\n    try:\r\n        rclpy.spin(sensor_processor)\r\n    except KeyboardInterrupt:\r\n        pass\r\n    finally:\r\n        sensor_processor.destroy_node()\r\n        rclpy.shutdown()\r\n\r\nif __name__ == \'__main__\':\r\n    main()\n'})}),"\n",(0,s.jsx)(n.h3,{id:"add-entry-point-to-setuppy",children:"Add Entry Point to setup.py"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"entry_points={\r\n    'console_scripts': [\r\n        'sensor_processor = my_robot_package.sensor_processor:main',\r\n    ],\r\n},\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"building-and-installing-the-package",children:"Building and Installing the Package"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-build-the-package",children:"Step 1: Build the Package"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Navigate to workspace root\r\ncd ~/ros2_ws\r\n\r\n# Build specific package\r\ncolcon build --packages-select my_robot_package\r\n\r\n# Or build all packages\r\ncolcon build\r\n\r\n# Build with symlink install (for faster Python development)\r\ncolcon build --symlink-install\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-2-source-the-workspace",children:"Step 2: Source the Workspace"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Source the setup file\r\nsource install/setup.bash\r\n\r\n# Add to ~/.bashrc for automatic sourcing\r\necho "source ~/ros2_ws/install/setup.bash" >> ~/.bashrc\n'})}),"\n",(0,s.jsx)(n.h3,{id:"step-3-run-the-node",children:"Step 3: Run the Node"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Run the node\r\nros2 run my_robot_package sensor_processor\r\n\r\n# Run with parameters\r\nros2 run my_robot_package sensor_processor --ros-args \\\r\n  -p window_size:=20 \\\r\n  -p max_angular_velocity:=10.0\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"creating-configuration-files",children:"Creating Configuration Files"}),"\n",(0,s.jsx)(n.h3,{id:"parameter-yaml-file",children:"Parameter YAML File"}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"config/sensor_params.yaml"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"sensor_processor:\r\n  ros__parameters:\r\n    window_size: 15\r\n    max_angular_velocity: 8.0\r\n    publish_rate: 100.0\r\n    \r\n    # Logging configuration\r\n    log_level: INFO\n"})}),"\n",(0,s.jsx)(n.h3,{id:"using-parameters-from-file",children:"Using Parameters from File"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 run my_robot_package sensor_processor --ros-args \\\r\n  --params-file src/my_robot_package/config/sensor_params.yaml\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"creating-launch-files",children:"Creating Launch Files"}),"\n",(0,s.jsx)(n.p,{children:"Launch files allow you to start multiple nodes with configurations."}),"\n",(0,s.jsx)(n.h3,{id:"python-launch-file",children:"Python Launch File"}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"launch/robot_bringup.launch.py"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from launch import LaunchDescription\r\nfrom launch_ros.actions import Node\r\nfrom launch.actions import DeclareLaunchArgument, ExecuteProcess\r\nfrom launch.substitutions import LaunchConfiguration\r\nfrom ament_index_python.packages import get_package_share_directory\r\nimport os\r\n\r\ndef generate_launch_description():\r\n    # Get package directory\r\n    pkg_dir = get_package_share_directory('my_robot_package')\r\n    \r\n    # Declare launch arguments\r\n    use_sim_time = LaunchConfiguration('use_sim_time', default='false')\r\n    config_file = LaunchConfiguration('config_file', \r\n                                     default=os.path.join(pkg_dir, 'config', 'sensor_params.yaml'))\r\n    \r\n    return LaunchDescription([\r\n        # Declare arguments\r\n        DeclareLaunchArgument(\r\n            'use_sim_time',\r\n            default_value='false',\r\n            description='Use simulation time if true'\r\n        ),\r\n        \r\n        DeclareLaunchArgument(\r\n            'config_file',\r\n            default_value=os.path.join(pkg_dir, 'config', 'sensor_params.yaml'),\r\n            description='Path to parameter file'\r\n        ),\r\n        \r\n        # IMU Publisher Node\r\n        Node(\r\n            package='my_robot_package',\r\n            executable='imu_publisher',\r\n            name='imu_publisher',\r\n            output='screen',\r\n            parameters=[{'use_sim_time': use_sim_time}]\r\n        ),\r\n        \r\n        # Sensor Processor Node\r\n        Node(\r\n            package='my_robot_package',\r\n            executable='sensor_processor',\r\n            name='sensor_processor',\r\n            output='screen',\r\n            parameters=[config_file, {'use_sim_time': use_sim_time}]\r\n        ),\r\n        \r\n        # Robot State Publisher\r\n        Node(\r\n            package='robot_state_publisher',\r\n            executable='robot_state_publisher',\r\n            name='robot_state_publisher',\r\n            output='screen',\r\n            parameters=[{\r\n                'robot_description': open(os.path.join(pkg_dir, 'urdf', 'robot.urdf')).read(),\r\n                'use_sim_time': use_sim_time\r\n            }]\r\n        ),\r\n        \r\n        # RViz for visualization\r\n        Node(\r\n            package='rviz2',\r\n            executable='rviz2',\r\n            name='rviz2',\r\n            arguments=['-d', os.path.join(pkg_dir, 'rviz', 'robot.rviz')],\r\n            condition=LaunchConfiguration('rviz', default='true')\r\n        ),\r\n    ])\n"})}),"\n",(0,s.jsx)(n.h3,{id:"running-the-launch-file",children:"Running the Launch File"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Run the launch file\r\nros2 launch my_robot_package robot_bringup.launch.py\r\n\r\n# With arguments\r\nros2 launch my_robot_package robot_bringup.launch.py use_sim_time:=true rviz:=false\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"package-organization-best-practices",children:"Package Organization Best Practices"}),"\n",(0,s.jsx)(n.h3,{id:"directory-structure-for-large-projects",children:"Directory Structure for Large Projects"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"my_robot_package/\r\n\u251c\u2500\u2500 my_robot_package/\r\n\u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u251c\u2500\u2500 nodes/              # Node implementations\r\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u2502   \u251c\u2500\u2500 sensor_node.py\r\n\u2502   \u2502   \u2514\u2500\u2500 controller_node.py\r\n\u2502   \u251c\u2500\u2500 utils/              # Utility modules\r\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u2502   \u251c\u2500\u2500 filters.py\r\n\u2502   \u2502   \u2514\u2500\u2500 transforms.py\r\n\u2502   \u2514\u2500\u2500 interfaces/         # Custom message/service definitions (if any)\r\n\u2502       \u2514\u2500\u2500 __init__.py\r\n\u251c\u2500\u2500 launch/\r\n\u2502   \u251c\u2500\u2500 robot_bringup.launch.py\r\n\u2502   \u2514\u2500\u2500 simulation.launch.py\r\n\u251c\u2500\u2500 config/\r\n\u2502   \u251c\u2500\u2500 sensor_params.yaml\r\n\u2502   \u2514\u2500\u2500 controller_params.yaml\r\n\u251c\u2500\u2500 urdf/\r\n\u2502   \u251c\u2500\u2500 robot.urdf\r\n\u2502   \u2514\u2500\u2500 robot.urdf.xacro\r\n\u251c\u2500\u2500 rviz/\r\n\u2502   \u2514\u2500\u2500 robot.rviz\r\n\u2514\u2500\u2500 test/\r\n    \u251c\u2500\u2500 test_sensor_node.py\r\n    \u2514\u2500\u2500 test_controller.py\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"testing-your-package",children:"Testing Your Package"}),"\n",(0,s.jsx)(n.h3,{id:"unit-test-example",children:"Unit Test Example"}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"test/test_sensor_processor.py"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import unittest\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom sensor_msgs.msg import Imu\r\nfrom my_robot_package.sensor_processor import SensorProcessor\r\n\r\nclass TestSensorProcessor(unittest.TestCase):\r\n    \r\n    @classmethod\r\n    def setUpClass(cls):\r\n        rclpy.init()\r\n    \r\n    @classmethod\r\n    def tearDownClass(cls):\r\n        rclpy.shutdown()\r\n    \r\n    def setUp(self):\r\n        self.node = SensorProcessor()\r\n    \r\n    def tearDown(self):\r\n        self.node.destroy_node()\r\n    \r\n    def test_anomaly_detection(self):\r\n        """Test that anomalies are correctly detected"""\r\n        # Normal angular velocity\r\n        self.assertFalse(self.node.is_anomaly(0.1, 0.1, 0.1))\r\n        \r\n        # Anomalous angular velocity\r\n        self.assertTrue(self.node.is_anomaly(10.0, 0.0, 0.0))\r\n    \r\n    def test_parameter_initialization(self):\r\n        """Test that parameters are correctly initialized"""\r\n        self.assertEqual(self.node.window_size, 10)\r\n        self.assertEqual(self.node.max_angular_vel, 5.0)\r\n\r\nif __name__ == \'__main__\':\r\n    unittest.main()\n'})}),"\n",(0,s.jsx)(n.h3,{id:"running-tests",children:"Running Tests"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Run all tests in package\r\ncolcon test --packages-select my_robot_package\r\n\r\n# View test results\r\ncolcon test-result --verbose\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"common-package-commands",children:"Common Package Commands"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# List all packages\r\nros2 pkg list\r\n\r\n# Get package information\r\nros2 pkg prefix my_robot_package\r\n\r\n# List package executables\r\nros2 pkg executables my_robot_package\r\n\r\n# Create package with dependencies\r\nros2 pkg create --build-type ament_python my_new_package \\\r\n  --dependencies rclpy std_msgs\r\n\r\n# Build specific package\r\ncolcon build --packages-select my_robot_package\r\n\r\n# Clean build\r\nrm -rf build install log\r\ncolcon build\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["[!TIP]\r\n",(0,s.jsx)(n.strong,{children:"Issue:"})," ",(0,s.jsx)(n.code,{children:"ModuleNotFoundError: No module named 'my_robot_package'"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Rebuild with symlink install\r\ncolcon build --symlink-install\r\nsource install/setup.bash\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["[!TIP]\r\n",(0,s.jsx)(n.strong,{children:"Issue:"})," Executable not found after adding to setup.py"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Rebuild the package\r\ncolcon build --packages-select my_robot_package\r\nsource install/setup.bash\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["[!TIP]\r\n",(0,s.jsx)(n.strong,{children:"Issue:"})," Launch file not found"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution:"}),"\r\nEnsure launch files are included in ",(0,s.jsx)(n.code,{children:"setup.py"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"(os.path.join('share', package_name, 'launch'),\r\n    glob(os.path.join('launch', '*launch.[pxy][yma]*'))),\n"})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ROS 2 packages organize code, configurations, and resources"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"package.xml"})," defines metadata and dependencies"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"setup.py"})," configures Python package installation"]}),"\n",(0,s.jsxs)(n.li,{children:["Entry points make nodes executable with ",(0,s.jsx)(n.code,{children:"ros2 run"})]}),"\n",(0,s.jsx)(n.li,{children:"Launch files start multiple nodes with configurations"}),"\n",(0,s.jsx)(n.li,{children:"Proper organization scales to large projects"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"In the next chapter, we'll dive deeper into launch files and parameter management for complex robot systems."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Creating-Your-First-ROS2-Package.html",children:"ROS 2 Package Creation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/How-To-Guides/Ament-CMake-Python-Documentation.html",children:"Python Setup.py Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://colcon.readthedocs.io/",children:"Colcon Build Tool"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);